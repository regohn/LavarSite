<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Daily Report Upload</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background-color: #f2f2f7;
      margin: 0;
      padding: 20px;
      color: #1c1c1e;
    }

    .container {
      max-width: 500px;
      margin: auto;
      background-color: white;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }

    h2 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 25px;
      color: #0a84ff;
    }

    label {
      display: block;
      margin-bottom: 15px;
      font-size: 14px;
    }

    input[type="date"],
    textarea,
    input[type="file"] {
      width: 100%;
      font-size: 15px;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 12px;
      background-color: #f9f9f9;
      margin-top: 5px;
      box-sizing: border-box;
    }

    input[type="file"] {
      padding: 8px;
    }

    textarea {
      resize: vertical;
    }

    button {
      width: 100%;
      background-color: #0a84ff;
      color: white;
      border: none;
      padding: 14px;
      font-size: 16px;
      border-radius: 16px;
      cursor: pointer;
      margin-top: 20px;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #006be6;
    }

    #status {
      text-align: center;
      margin-top: 20px;
      font-size: 15px;
      color: #4caf50;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Submit Daily Report</h2>
    <form id="uploadForm">
      <label>Report Date:
        <input type="date" name="reportDate" required>
      </label>

      <label>Comments:
        <textarea name="comments" rows="4" required></textarea>
      </label>

      <label>Image 1:
        <input type="file" name="image1" accept="image/*">
      </label>

      <label>Image 2:
        <input type="file" name="image2" accept="image/*">
      </label>

      <label>Image 3:
        <input type="file" name="image3" accept="image/*">
      </label>

      <label>Image 4:
        <input type="file" name="image4" accept="image/*">
      </label>

      <button type="submit">Submit Report</button>
    </form>

    <p id="status"></p>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxrqZKjjtLqnrSEMsEISfDuBVfcvncN7LpdFoiRPBdscFe8KwZlxupWF66hL2hBITbuEw/exec";

        document.getElementById("uploadForm").addEventListener("submit", async function (e) {
        e.preventDefault();
        const form = e.target;
        const status = document.getElementById("status");
        status.style.color = "#1c1c1e";
        status.innerText = "Uploading report, please wait...";

        const formData = new FormData(form);

      const plainData = {
        reportDate: formData.get("reportDate"),
        comments: formData.get("comments")
      };

      for (let i = 1; i <= 4; i++) {
        const file = formData.get(`image${i}`);
        if (file && file.size > 0) {
          const base64 = await toBase64(file);
          plainData[`image${i}`] = base64.split(",")[1];
          plainData[`image${i}_name`] = file.name;
        }
      }

      const urlEncoded = new URLSearchParams(plainData).toString();

      fetch(scriptURL, {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: urlEncoded
      })
      .then(res => res.text())
      .then(txt => {
        document.getElementById("status").innerText = txt;
        form.reset();
      })
      .catch(err => {
        document.getElementById("status").innerText = "Error: " + err.message;
        document.getElementById("status").style.color = "#ff3b30";
      });
    });

    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
      });
    }
  </script>
</body>
</html>
